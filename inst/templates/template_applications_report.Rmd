---
params:
  anon_path: "data/applications_anonymized.csv"
  project_id: "{{{project_id}}}"
output: rmdformats::robobook
title: "Applications for project `r toupper(params$project_id)`"
---
<!-- THIS FILE IS NOT SUPPOSED TO BE KNITTED DIRECTLY
    INSTEAD IT IS KNIT FROM 01_preparte_team_selection.R
    IF YOU WANT TO KNIT THIS BY HAND, SET THE PARAMETERS ACCORDINGLY
-->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r include=FALSE, message=FALSE}
library(tidyverse)
PROJECT_ID <- params$project_id
ANON_PATH <- params$anon_path
appl <- readr::read_csv(ANON_PATH)
```

# Introduction
### Helpful links for team selection committee
- [Team selection criteria and best practices](https://docs.correlaid.org/project-manual/project-coordinators/ideation-finding-a-team#team-selection-call)
- [Explanation of the experience scale](https://docs.correlaid.org/project-manual/data4good-projects#experience-scale) ("Beginner", "User", "Advanced", "Expert") 
- [Explanation of the team roles](https://docs.correlaid.org/project-manual/data4good-projects#which-project-role)

### Project roles by gender
```{r}
theme_set(correltools::theme_correlaid())
ggplot(appl, aes(x = project_role, fill = gender))+
  geom_bar(position = position_dodge2(preserve = "single", padding = 0))+
  correltools::scale_fill_correlaid_d()+
  theme(axis.title.x = element_blank())+
  labs(y = 'n')
```

```{r female, results='asis', echo=FALSE}
female <- appl %>% 
  filter(gender == "female") %>% 
  arrange(project_role) %>% 
  pull(applicant_id)

res <- lapply(female, function(x) {
  params <- list(applicant_id = x, anon_path = ANON_PATH)
  knitr::knit_child(
    'zzz_template_application_single.Rmd', envir = environment(), quiet = TRUE
  )
})

cat(unlist(res), sep = '\n')
```


```{r male, results='asis'}
male <- appl %>% 
  filter(gender == "male") %>% 
  arrange(applicant_id) %>% 
  pull(applicant_id)
res <- lapply(male, function(x) {
  params <- list(applicant_id = x, anon_path = ANON_PATH)
  knitr::knit_child(
    'zzz_template_application_single.Rmd', envir = environment(), quiet = TRUE
  )
})
cat(unlist(res), sep = '\n')
```

```{r div-nonbinary, results='asis'}
div_nonbinary <- appl %>% 
  filter(!gender %in% c("female", "male")) %>% 
  arrange(applicant_id) %>% 
  pull(applicant_id)

res <- lapply(div_nonbinary, function(x) {
  params <- list(applicant_id = x, anon_path = ANON_PATH)
  knitr::knit_child(
    'zzz_template_application_single.Rmd', envir = environment(), quiet = TRUE
  )
})

cat(unlist(res), sep = '\n')
```